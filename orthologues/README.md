# Orthologues
**Adrián Barreno Sánchez (adrian.barreno@alumnos.upm.es), Pablo Mata Aroco (p.mata@alumnos.upm.es), Alberto González Delgado (alberto.gondelgado@alumnos.upm.es), Julian Elijah Politsch (julian.politsch@alumnos.upm.es), Angelo D'Angelo (angelo.dangelo@alumnos.upm.es)**


## What is Orthologues?

Orthologues is a computer program designed in ruby to search two fa representing the proteme of two related organisms and search for orthologs of species A to species B. Secondly, the script checks if the orrthologues are reciprocal by blasting species B to A. Those reciprical blast results are strong evidence of orthologous genes, but further methedology to prove orthology is outlined at the end of this document.

## How to run Orthologues?

Download the code as [README file for assignment answers](../README.md) indicates.

## BLAST options and filtering criteria

After a quick search of the scientific literature, we came up with a comparative analysis of BLAST options for the detection of orthologous genes using the Reciprocal Best Hit approach. [Gabriel Moreno-Hagelsieb and Kristen Latimer (2009)](https://academic.oup.com/bioinformatics/article/24/3/319/252715?login=false) tuned two BLAST parameters that significantly affected the alignment scores and, therefore, the election of best hits: 1. the filtering of low information sequence segments and the algorithm used to produce the alignment. Based on the results obtained, the authors recommended using a combination of soft filtering with a Smith–Waterman final alignment algorithm (-F "m S" -s T) options, which provides the highest number of orthologs and the minimal error rates.

The first blast is of type "tblastn" while the reciprical blast is type "blastx"

## Requirements:

* [BioRuby-Gem](https://rubygems.org/gems/bio-gem/versions/1.3.6)
```
gem install bio-gem
```
* [Fasta files](https://drive.google.com/drive/folders/0B7FLMiAz5IXPTWJDSkk1MTFPMjg?resourcekey=0-yhXCH6PxXIvg9xwMSolpMw)

* Create the BLAST-formatted databases for BLAST analysis. We need to create a database for each reference proteome using the following command:
```
makeblastdb -in ./files/{Fasta File} -dbtype 'prot' -out ./databases/{BLAST Database}
```

## Usage:

To run the program, execute the following command (inside orthologues/ folder), adding the arguments recquired:

```
cd assignments_answers/orthologues/
```
```
ruby main.rb <Arabidopsis_db> <S_pombe_Database> <Arabidopsis.fa>  <S_pombe.fa> <output_file>
```
**Arguments:**
1. **Arabidopsis_Database**
2. **S_pombe_Database**
3. **Arabidopsis.fa** 
4. **S_pombe.fa**
2. **Output_file**: file where the report will be saved. Here there is an  [ouput txt file](documents/) that shows the file generated by the program.

If output pathway specified already exists, the program will ask you if you want to overwrite it. Y/y (yes) or N/n (no) input is expected.

## Output
- Output_file contains the results of the BLAST as well as other statistical information

- The command line output is verbose, some of which will be saved into a [output txt file](documents/). 


## Bonus Point:

There are several steps that can be taken to further analyze putative orthologues and confirm their orthology. We will outline the three that we have studied in other classes:

1. Compare the sequences of the suspected orthologues at a protein level. This can be done using a tool like the ClustalW, which aligns the amino acid sequences of the two proteins and calculates their degree of similarity. If the proteins are highly similar and the alignment is biologically meaningful, this is strong evidence that the genes are orthologues.

2. Compare the biological functions of the orthologous genes. While similar to point 1, if the genes contain functional notation it would be strong evidence or orthology. This information can be obtained by looking up the known functions of the genes in databases or by performing functional assays in a laboratory.

3. A third approach is to examine the evolutionary relationships by constructing a phylogenetic tree. This can be done by aligning the nucleotide or amino acid sequences of the genes from multiple organisms and using a method such as maximum likelihood to infer the evolutionary relationships between the sequences. If the two genes cluster together on the final trees, it is strong evidence of their orthology.

## References

* Gabriel Moreno-Hagelsieb, Kristen Latimer, Choosing BLAST options for better detection of orthologs as reciprocal best hits, Bioinformatics, Volume 24, Issue 3, 1 February 2008, Pages 319–324, https://doi.org/10.1093/bioinformatics/btm585

